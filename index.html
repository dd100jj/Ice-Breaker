<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Ice Breaker Gold</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-bg: var(--tg-theme-bg-color, #f0f2f5);
            --card-bg: #ffffff;
            --text-main: #222222;
            --accent-orange: #ff8a65;
            --accent-blue: #4fc3f7;
            --accent-water: #00bcd4; /* ì›Œí„° ì „ìš© ìƒ‰ìƒ */
            --gray-text: #888888;
            --danger: #ff5252;
            --vip-gold: #fbc02d;
        }
        body { background-color: var(--tg-bg); color: var(--text-main); font-family: 'Pretendard', sans-serif; margin: 0; padding: 15px; display: flex; flex-direction: column; gap: 12px; overflow-x: hidden; }
        .card { background: var(--card-bg); border-radius: 15px; padding: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); display: flex; flex-direction: column; }
        
        .top-bar { display: flex; justify-content: space-between; align-items: center; }
        .level-tag { background: #ffcc80; color: white; padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 12px; }
        .wallet-btn { background: #fff; border: 1.5px solid var(--accent-blue); color: var(--accent-blue); padding: 8px 15px; border-radius: 20px; font-weight: bold; font-size: 13px; display: flex; align-items: center; gap: 8px; cursor: pointer; }

        /* ìì› í‘œì‹œ ì¤„ ìˆ˜ì • (ì›Œí„° ì¶”ê°€) */
        .resource-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 5px; }
        .res-item { background: #fff; padding: 10px; border-radius: 12px; border: 1px solid #eee; text-align: center; }
        .res-label { font-size: 9px; color: var(--gray-text); font-weight: bold; margin-bottom: 2px; }
        .res-value { font-size: 14px; font-weight: 800; }

        .ice-header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .gauge-track { width: 100%; height: 20px; background: #f0f2f5; border-radius: 10px; overflow: hidden; border: 1px solid #eee; position: relative; margin: 5px 0; }
        .gauge-fill { width: 0%; height: 100%; background: linear-gradient(90deg, #4fc3f7, #81d4fa); transition: width 0.3s ease; position: relative; }
        .gauge-fill::after { content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); animation: ice-shine 2s infinite; }
        @keyframes ice-shine { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        .asset-amount { font-size: 24px; font-weight: 900; }

        .mine-card { align-items: center; text-align: center; gap: 6px; }
        .ice-cube { font-size: 85px; margin: 10px 0; cursor: pointer; transition: transform 0.1s; user-select: none; }
        .ice-cube:active { transform: scale(0.9); }
        .mining-power { font-size: 28px; font-weight: 800; }
        .mining-speed { color: var(--accent-orange); font-weight: bold; font-size: 14px; }

        .shop-area { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .shop-btn { border: none; border-radius: 12px; padding: 12px; font-weight: bold; color: white; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 4px; font-size: 14px; }

        /* ëª¨ë‹¬ ì•„ì´í…œ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; align-items: center; justify-content: center; }
        .modal-content { width: 92%; background: white; border-radius: 25px; padding: 20px; display: flex; flex-direction: column; gap: 12px; box-sizing: border-box; max-height: 90vh; overflow-y: auto; }
        .item-row { display: flex; justify-content: space-between; align-items: center; padding: 12px; border-bottom: 1px solid #f0f0f0; }
        .item-main { display: flex; align-items: center; gap: 12px; }
        .buy-small-btn { background: var(--accent-blue); color: white; border: none; padding: 8px 14px; border-radius: 8px; font-size: 11px; font-weight: bold; }
        .close-icon { cursor:pointer; font-size:24px; color:#ccc; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="level-tag" id="level-display">â­ LV.1</div>
        <div class="wallet-btn" onclick="openWallet()">
            <span>ğŸ‘› Wallet</span>
            <span id="usdt-preview">0.00 USDT</span>
        </div>
    </div>

    <div class="resource-row">
        <div class="res-item">
            <div class="res-label">ğŸ’§ MY WATER</div>
            <div class="res-value" id="water-balance" style="color:var(--accent-water);">0</div>
        </div>
        <div class="res-item">
            <div class="res-label">ğŸ”¥ BOOSTER</div>
            <div class="res-value" id="booster-status" style="color:var(--accent-orange);">OFF</div>
        </div>
    </div>

    <div class="card">
        <div class="ice-header-row">
            <div style="font-size:13px; font-weight:bold; color:var(--gray-text);">ğŸ§Š Ice container</div>
            <div id="ice-to-usdt" style="font-size:12px; font-weight:bold; color:var(--accent-orange);">0.00000 USDT</div>
        </div>
        <div class="gauge-track">
            <div id="ice-gauge-bar" class="gauge-fill"></div>
        </div>
        <div class="asset-amount" id="balance">0</div>
    </div>

    <div class="card mine-card">
        <div class="ice-cube" onclick="mineClick(event)">ğŸ§Š</div>
        <div class="mining-power" id="mining-power">+ 0.00000</div>
        <div class="mining-speed">+ 0.00005 / sec</div>
        <div style="margin-top:5px;">
            <button onclick="watchAdForWater()" style="background:var(--accent-water); border:none; color:white; padding:8px 15px; border-radius:15px; font-size:11px; font-weight:bold; cursor:pointer;">ğŸ“º Get Water (Watch AD)</button>
        </div>
    </div>

    <div class="shop-area">
        <button class="shop-btn" style="background:#42a5f5;" onclick="openShop('upgrade')">ğŸ›’ UPGRADE</button>
        <button class="shop-btn" style="background:#ff7043;" onclick="openShop('special')">ğŸ SPECIAL</button>
    </div>

    <div id="shop-modal" class="modal"><div class="modal-content"><div style="display:flex; justify-content:space-between; align-items:center;"><h2 id="shop-title" style="margin:0; font-size:18px;">Shop</h2><span onclick="closeModal('shop-modal')" class="close-icon">&times;</span></div><div id="shop-items-container"></div></div></div>
    
    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let shards = 0;
        let water = 0; // ì‹ ê·œ ì¬í™”: ì›Œí„°
        let power = 0.00000;
        let level = 1;
        const autoSpeed = 0.00005;

        setInterval(() => {
            power += autoSpeed;
            document.getElementById('mining-power').innerText = "+ " + power.toFixed(5);
        }, 1000);

        function watchAdForWater() {
            tg.showConfirm("ê´‘ê³ ë¥¼ ë³´ê³  ğŸ’§ì›Œí„° 50ê°œë¥¼ ë°›ìœ¼ì‹œê² ìŠµë‹ˆê¹Œ?", (ok) => {
                if(ok) {
                    water += 50;
                    updateUI();
                    tg.showAlert("ğŸ’§ ì›Œí„° 50ê°œë¥¼ íšë“í–ˆìŠµë‹ˆë‹¤! ìƒì ì—ì„œ ì•„ì´í…œì„ êµ¬ë§¤í•˜ì„¸ìš”.");
                }
            });
        }

        function updateUI() {
            document.getElementById('balance').innerText = shards.toLocaleString();
            document.getElementById('water-balance').innerText = water.toLocaleString();
            document.getElementById('level-display').innerText = `â­ LV.${level}`;
            const currentUSDT = (shards / 1400).toFixed(5);
            document.getElementById('ice-to-usdt').innerText = currentUSDT + " USDT";
            document.getElementById('usdt-preview').innerText = (shards / 1400).toFixed(2) + " USDT";
            let percent = Math.min((shards / 1400) * 100, 100);
            document.getElementById('ice-gauge-bar').style.width = percent + "%";
        }

        function openShop(type) {
            const container = document.getElementById('shop-items-container');
            container.innerHTML = "";
            document.getElementById('shop-title').innerText = type.toUpperCase();
            
            if(type === 'upgrade') {
                const items = [
                    { emoji: "ğŸ§¤", name: "ê°€ì£½ ì¥ê°‘", desc: "í´ë¦­ ì±„êµ´ëŸ‰ +1", price: "100 Water" },
                    { emoji: "â›ï¸", name: "ë¬´ë”˜ ê³¡ê´­ì´", desc: "+0.0001/ì´ˆ ì±„êµ´", price: "250 Water" },
                    { emoji: "ğŸ”¥", name: "ì†ë‚œë¡œ", desc: "ì±„êµ´ íš¨ìœ¨ ì¦ê°€", price: "500 Water" },
                    { emoji: "ğŸšœ", name: "ë¯¸ë‹ˆ ì œì„¤ì°¨", desc: "+0.0010/ì´ˆ ì±„êµ´", price: "1,200 Water" }
                ];
                items.forEach(item => { 
                    container.innerHTML += `<div class="item-row"><div class="item-main"><span style="font-size:24px;">${item.emoji}</span><div style="text-align:left;"><h4>${item.name}</h4><p style="font-size:10px; color:#888;">${item.desc}</p></div></div><button class="buy-small-btn" onclick="buyItem('${item.price}')">${item.price}</button></div>`;
                });
            } else {
                // ìŠ¤í˜ì…œì€ ê¸°ì¡´ëŒ€ë¡œ í…Œë”(USDT) ìœ ì§€
                container.innerHTML += `<p style="font-size:11px; color:var(--danger); text-align:center;">Special items require USDT payment.</p>`;
            }
            document.getElementById('shop-modal').style.display = 'flex';
        }

        function buyItem(priceStr) {
            let cost = parseInt(priceStr);
            if(water >= cost) {
                water -= cost;
                updateUI();
                tg.showAlert("êµ¬ë§¤ ì™„ë£Œ!");
            } else {
                tg.showAlert("ğŸ’§ ì›Œí„°ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤! ê´‘ê³ ë¥¼ ë³´ê³  ì¶©ì „í•˜ì„¸ìš”.");
            }
        }

        function mineClick(event) {
            if (power >= 1) {
                let harvest = Math.floor(power);
                shards += harvest;
                power -= harvest;
                updateUI();
                if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
            } else { tg.showAlert("Collect at least 1 ICE!"); }
        }

        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    </script>
</body>
</html>
